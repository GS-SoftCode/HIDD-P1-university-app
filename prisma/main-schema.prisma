generator mainClient {
  provider = "prisma-client-js"
  output   = "./prisma-clients/main-client"
}

datasource db_main {
  provider = "postgresql"
}

model Admin {
  id_admin Int @id @default(autoincrement())
  userId   Int @unique
}

model Docente {
  id_docente   Int      @id @default(autoincrement())
  userId       Int      @unique
  especialidad String
  materias     Docente_Materia[]
}

model Estudiante {
  id_estudiante    Int      @id @default(autoincrement())
  userId           Int      @unique
  fecha_nacimiento DateTime
  id_carrera       Int
  estado           EstadoEstudiante @default(Activo)
  carrera          Carrera  @relation(fields: [id_carrera], references: [id_carrera])
  materias         Estudiante_Materia[]
  
  @@index([id_carrera])
}

  enum EstadoEstudiante {
      Activo
      Inactivo
      Graduado
      Retirado
    }

model Carrera {
  id_carrera  Int          @id @default(autoincrement())
  nombre      String
  duracion    Int
  facultad    String
  ciclos      Ciclo[]
  estudiantes Estudiante[]
}

model Periodo {
  id_periodo        Int                  @id @default(autoincrement())
  nombre            String               @unique
  activo            Boolean              @default(false)
  docente_materias  Docente_Materia[]
  estudiante_materias Estudiante_Materia[]
}

model Ciclo {
  id_ciclo   Int      @id @default(autoincrement())
  nombre     String
  numero     Int
  id_carrera Int
  carrera    Carrera  @relation(fields: [id_carrera], references: [id_carrera])
  materias   Materia[]
  
  @@index([id_carrera])
}

model Materia {
  id_materia  Int                  @id @default(autoincrement())
  nombre      String
  codigo      String               @unique
  creditos    Int
  id_ciclo    Int
  ciclo       Ciclo                @relation(fields: [id_ciclo], references: [id_ciclo])
  docentes    Docente_Materia[]
  estudiantes Estudiante_Materia[]
  
  @@index([id_ciclo])
}

model Docente_Materia {
  id_docente Int
  id_materia Int
  id_periodo Int
  docente    Docente @relation(fields: [id_docente], references: [id_docente])
  materia    Materia @relation(fields: [id_materia], references: [id_materia])
  periodo    Periodo @relation(fields: [id_periodo], references: [id_periodo])
  
  @@id([id_docente, id_materia, id_periodo])
  @@index([id_docente])
  @@index([id_materia])
  @@index([id_periodo])
}

model Estudiante_Materia {
  id_estudiante     Int
  id_materia        Int
  id_periodo        Int
  fecha_inscripcion DateTime
  estudiante        Estudiante @relation(fields: [id_estudiante], references: [id_estudiante])
  materia           Materia    @relation(fields: [id_materia], references: [id_materia])
  periodo           Periodo    @relation(fields: [id_periodo], references: [id_periodo])
  
  @@id([id_estudiante, id_materia, id_periodo])
  @@index([id_estudiante])
  @@index([id_materia])
  @@index([id_periodo])
}